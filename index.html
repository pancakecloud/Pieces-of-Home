<style>
  #webcamButton {
    position: absolute;
    z-index: 999;
  }
  
  #output_canvas, video {
    display:none;
  }
  
    #container {
    display: flex;
    flex-direction: row;
  }

  #container > div {
    height: 180px;
    /* background: grey; */
    border: 1px solid white;
    flex-grow: 1;
  }

  .animation {
    height: 20px;
    background: red;
  }

  .annotation {
    display: flex;
    justify-content: space-between;
  }

  .plane {
    height: 40px;
    /* background: yellow; */
  }

  h1,
  h2 {
    font-family: "fractul-variable", sans-serif;
    font-variation-settings: "wght" 400;
    margin: 0;
  }
  

</style>
<script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>

<link
  href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css"
  rel="stylesheet"
/>
<script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>

<body>
  <div id="liveView" class="videoView">
    <button id="webcamButton" class="mdc-button mdc-button--raised">
      <span class="mdc-button__ripple"></span>
      <span class="mdc-button__label">ENABLE WEBCAM</span>
    </button>
    <div style="position: relative">
      <video
        id="webcam"
        style="width: 1280px; height: 720px; position: abso"
        autoplay
        playsinline
      ></video>
      <canvas
        class="output_canvas"
        id="output_canvas"
        width="1280"
        height="720"
        style="position: absolute; left: 0px; top: 0px"
      ></canvas>
    </div>
  </div>


<div id="container">
  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>IND</span>
      </div>
    </div>
    <h1>Indian Thalli</h1>
    <h2>YMCA</h2>
    <h2>1810</h2>
  </div>

  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>CHN</span>
      </div>
    </div>
    <h1>Prawn & Chive Dumplings</h1>
    <h2>DIMSUM DUCK</h2>
    <h2>1907</h2>
  </div>

  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>ITL</span>
      </div>
    </div>
    <h1>Ravioli Of Ricotta With Sage Butter</h1>
    <h2>Padella</h2>
    <h2>1945</h2>
  </div>

  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>CRB</span>
      </div>
    </div>
    <h1>Jerk Chicken</h1>
    <h2>Maureen's Brixton Kitchen</h2>
    <h2>1948</h2>
  </div>

  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>NGA</span>
      </div>
    </div>
    <h1>Suya Beef</h1>
    <h2>Angels Bakery</h2>
    <h2>1950</h2>
  </div>

  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>GRK</span>
      </div>
    </div>
    <h1>Dolmades</h1>
    <h2>Babinodas</h2>
    <h2>1950-60</h2>
  </div>

  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>TK</span>
      </div>
    </div>
    <h1>Lamb adana kebab</h1>
    <h2>Gokyuzu</h2>
    <h2>1950-1960</h2>
  </div>

  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>PTG</span>
      </div>
    </div>
    <h1>Lulas Grelhadas</h1>
    <h2>Grelha D'ouro</h2>
    <h2>1960-70</h2>
  </div>

  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>BGD</span>
      </div>
    </div>
    <h1>Chingri Malai Curry</h1>
    <h2>Kolapata</h2>
    <h2>1970</h2>
  </div>

  <div>
    <div class="plane">
      <div class="animation"></div>
      <div class="annotation">
        <span>LND</span>
        <span>&rarr;</span>
        <span>KRN</span>
      </div>
    </div>
    <h1>Tteokbokki</h1>
    <h2>Kang Nam</h2>
    <h2>1990</h2>
  </div>
</div>


  <script type="module" src="/script.js"></script>

  <a-scene>
   <script>
     
     const flipZone = 0.1; // percentage of screen where the coin flips
     
      AFRAME.registerComponent("nose", {
        tick: function () {
          if (this.previous === undefined) {
            this.previous = window.nose;
            return;
          }
        },
      });

      AFRAME.registerComponent("coin", {
        schema: {
          threshold: { type: "number", default: 0.5 },
        },
        init: function () {
          this.targetRotation = 0;
          this.currentRotation = 0;
        },
        tick: function () {
          if (!window.noseFound) return;

          //var nose = /1 - window.nose.x;
          var distance = Math.abs(this.data.threshold - (1 - window.nose.x));
          
          if (distance < flipZone ) {
            this.targetRotation = 0; // set target rotation to 300 degrees
          } else {
            this.targetRotation = 180; // set target rotation to 0 degrees
          }

          // Apply exponential moving average to smooth the rotation
          this.currentRotation =
            this.currentRotation * 0.95 + this.targetRotation * 0.05;

          // Set the new rotation directly in degrees
          this.el.setAttribute("rotation", {
            x: 0,
            y: this.currentRotation,
            z: 0,
          });
        },
      });
    </script>

    <a-entity nose></a-entity>
    <a-camera position="0 0 2" fov="60" look-controls="enabled: false" wasd-controls="enabled: false"></a-camera>
    <a-entity position="-5 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.25" gltf-model="models/1.glb"></a-entity>
    <a-entity position="-3.9 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.5" gltf-model="models/2.glb"></a-entity>
    <a-entity position="-2.8 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.5" gltf-model="models/3.glb"></a-entity>
    <a-entity position="-1.7 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.5" gltf-model="models/4.glb"></a-entity>
    <a-entity position="-0.55 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.5" gltf-model="models/5.glb"></a-entity>
    <a-entity position="0.6 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.5" gltf-model="models/6.glb"></a-entity>
    <a-entity position="1.7 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.5" gltf-model="models/7.glb"></a-entity>
    <a-entity position="2.8 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.5" gltf-model="models/8.glb"></a-entity>
    <a-entity position="3.9 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.5" gltf-model="models/9.glb"></a-entity>
    <a-entity position="5 0 -7" scale="0.5 0.5 0.5" coin="threshold:0.75" gltf-model="models/10.glb"></a-entity>
    
    
  </a-scene>
</body>
